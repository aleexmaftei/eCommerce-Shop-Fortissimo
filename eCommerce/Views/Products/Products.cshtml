@model eCommerce.Models.ProductVM.ProductsWithValues.AllProductsVM
@inject eCommerce.Entities.DTOs.CurrentUserDto CurrentUser

<script src="~/js/products.js"></script>
<link rel="stylesheet" href="~/css/products.css" />
<link rel="stylesheet" href="~/css/filterProducts.css" />

<input type="hidden" id="deleteActionUrl" data-delete-action-url="@Url.Action("SoftDeleteProduct", "Admin")" />
<input type="hidden" id="updateActionUrl" data-update-action-url="@Url.Action("UpdateProduct", "Admin")" />
<input type="hidden" id="addProductToCartUrl" data-add-product-to-cart-url="@Url.Action("AddProductToCart", "Cart")" />

<div class="row">
    <div class="grid-container">
        <!-- Filter bar -->
        <div class="thin grid-section">
            <div class="rs-search-keyfeatures-filter">
                <div class="rs-sidebar-box">
                    <div class="filter-box tr-keyfeature-filter-box">
                        <div class="headline">
                            <strong>Filter</strong>
                        </div>

                        <div class="body">
                            <form method="get">
                                <input type="hidden" id="tr-keyfeatures-category" />
                                <!-- un for aici -->
                                <div class="feature-wrapper tr-keyfeatures-feature ">
                                    <div class="feature-block manufacturer">
                                        <label for="keyfeaturefilter-manufacturer-select">
                                            Manufacturer
                                        </label>


                                        <div class="body tr-keyfeatures-feature-selector">
                                            <select id="keyfeaturefilter-manufacturer-select" multiple="multiple" class="tr-custom-inputs" style="display:none;">
                                                <!-- for cu brandurile curente -->
                                                <option value="Ibanez" data-manufacturer-id="1">
                                                    Ibanez
                                                </option>
                                                <option value="Fender" data-manufacturer-id="2">
                                                    Fender
                                                </option>
                                            </select>

                                            <div class="tr-custom-input-select">
                                                <div class="tr-custom-input-select-selected" style="display:block;"></div>
                                                <!-- visible labels -->
                                                <div class="tr-custom-input-select-visible">
                                                    <label>
                                                        <input class="rs-input" type="checkbox" style="display:none;" />
                                                        <div class="rs-input checkbox">
                                                            <input class="checkbox" type="checkbox" />
                                                            <span class="label">Ibanez</span><span class="affected-value tr-custom-input-select-affected">(nr1)</span>
                                                        </div>

                                                    </label>

                                                    <label>
                                                        <input class="rs-input" type="checkbox" style="display:none;" />
                                                        <div class="rs-input checkbox">
                                                            <input class="checkbox" type="checkbox" />
                                                            <span class="label">Fender</span><span class="affected-value tr-custom-input-select-affected">(nr2)</span>
                                                        </div>
                                                    </label>
                                                </div>

                                                <!-- hidden labels -->
                                                <div class="tr-custom-input-select-hidden">
                                                    <!-- un for ceva aici -->
                                                    <label>
                                                        <input class="rs-input" type="checkbox" style="display:none;" />
                                                        <div class="rs-input checkbox">
                                                            <div class="checkbox"></div>
                                                            <span class="label">PRS</span><span class="affected-value tr-custom-input-select-affected">(nr2)</span>
                                                        </div>
                                                    </label>
                                                    <!-- gata for -->
                                                </div>
                                                <a href="#" class="tr-custom-input-select-collapse-link">
                                                    More
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- gata for -->
                            </form>
                            <div class="tr-keyfeatures-feature-separator"></div>
                            <a href="#" class="tr-keyfeatures-reset-all tr-display-block tr-text-center">Remove filters</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Product List -->
        <div class="phat grid-section">
            <!-- HEADER -->
            <div class="rs-search-dir rs-search-header">
                <h1>@Model.Allproducts[0].AllPropertiesWithValues[0].Value</h1>
                <div class="subtitle">
                    <span class="result-count">@Model.ProductsCount </span>
                    results. Articles from
                    <span id="search-entries-shown-from">1</span>
                    -
                    <span id="search-entries-shown-to">25</span>.
                    <br />
                </div>
            </div>
            <!-- Products -->
            <div class="rs-search-dir rs-search-list">
                <div class="rs-search-list-react"></div>
                <div id="resultsContainer" class="results">
                    <div id="defaultResultPage" class="response articles-list">
                        <!--aici for-ul-->
                        @foreach (var product in Model.Allproducts)
                        {
                            <div class="extensible-article list-view compare parent divToDelete">
                                <!-- Product Image -->
                                <div class="left">
                                    <div class="product-image image-block">
                                        <a href="#" class="article-link link">
                                            <img class="image" src="https://thumbs.static-thomann.de/thumb/orig/pics/prod/449491.webp"
                                                 style="height:190px;width:auto;" />
                                        </a>
                                    </div>
                                </div>
                                <!-- Product Details-->
                                <div class="right">
                                    <div class="top">
                                        <!-- Product Name + brand-->
                                        <div class="head">
                                            <a href="#" class="article-link link">
                                                <div class="title-block link-group">
                                                    <span class="manufacturer">Ibanez</span>
                                                    <span class="model">@product.ProductName</span>
                                                </div>

                                                <div class="subline">
                                                    <div class="subtitle-block">
                                                        <div>@product.AllPropertiesWithValues[0].Value  <span class="fas fa-chevron-right fa-xs"></span>  @product.AllPropertiesWithValues[1].Value</div>
                                                    </div>
                                                </div>

                                                <div class="features-block">
                                                    <ul class="prod-features">
                                                        <li>
                                                            <div><span class="fas fa-angle-double-right fa-1x" aria-hidden="true"></span>  @product.AllPropertiesWithValues[4].PropertyName: @product.AllPropertiesWithValues[4].Value</div>
                                                        </li>

                                                        <li>
                                                            <div><span class="fas fa-angle-double-right fa-1x" aria-hidden="true"></span>  @product.AllPropertiesWithValues[6].PropertyName: @product.AllPropertiesWithValues[6].Value</div>
                                                        </li>
                                                        <li>
                                                            <div><span class="fas fa-angle-double-right fa-1x" aria-hidden="true"></span>  @product.AllPropertiesWithValues[5].PropertyName: @product.AllPropertiesWithValues[5].Value</div>
                                                        </li>
                                                        <li>
                                                            <div><span class="fas fa-angle-double-right fa-1x" aria-hidden="true"></span>  @product.AllPropertiesWithValues[12].PropertyName: @product.AllPropertiesWithValues[12].Value</div>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </a>
                                        </div>
                                        <!-- Price -->
                                        <div class="body">
                                            <div class="price-block">
                                                <div class="primary">
                                                    <span class="article-basketlink">@product.ProductPrice $</span>
                                                </div>
                                            </div>

                                            <div class="manufacturer-block">
                                                <div class="rs-tooltip-trigger rs-tooltip-ready">
                                                    <a class="link" title="">
                                                        <img class="image" src="https://thumbs.static-thomann.de/thumb/ethumb105x40/pics/herstlogos/harley_benton.jpg" />
                                                    </a>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="tail">
                                            <div class="availability-block">
                                                <div class="rs-layover-trigger tr-availability-layover rs-tooltip-ready">
                                                    <a href="#">
                                                        <div class="tr-prod-availability tr-prod-availability-in">
                                                            <span class="fas fa-battery-full fa-1x"></span>  In stock

                                                        </div>
                                                    </a>
                                                </div>
                                            </div>

                                            <!-- Admin Buttons -->
                                            @if (CurrentUser.IsAdmin == true)
                                            {
                                                <div id="admin-buttons" class="d-flex justify-content-center">
                                                    <button type="button" data-target="#modalBox" data-toggle="modal"
                                                            data-product-id="@product.ProductId"
                                                            class="updateBtn button as-plain btn">
                                                        Update
                                                    </button>

                                                    <button type="button" data-product-id="@product.ProductId"
                                                            class="deleteBtn button as-plain btn">
                                                        Delete
                                                    </button>
                                                </div>
                                            }

                                            <div class="controls-block">
                                                <div class="item add-to-basket">
                                                    <form method="post">
                                                        <button type="submit" data-product-id="@product.ProductId"
                                                                class="button as-plain btn float-right addToCart">
                                                            <span class="fas fa-shopping-cart pr-2"></span>Add to Cart
                                                        </button>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!--Modal Product Update-->
<div class="modal fade" id="modalBox" tabindex="-1" role="dialog" aria-labelledby="modalLabel"
     aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable" role="document">
        <div class="modal-content">

            <div class="modal-header">
                <h4 class="modal-title" id="modalLabel">Update selected product</h4>
                <button type="button" class="close closeBtnModal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>

            <div class="modal-body">
                <form>
                    <div class="form-group">
                        <label asp-for="AdminUpdateDetails.ProductName" class="control-label"></label>
                        <input asp-for="AdminUpdateDetails.ProductName" id="productNameInput" class="form-control" />
                        <span asp-validation-for="AdminUpdateDetails.ProductName" class="text-danger"></span>
                    </div>

                    <div class="form-group insertAfterThis">
                        <label asp-for="AdminUpdateDetails.Quantity" class="control-label"></label>
                        <input asp-for="AdminUpdateDetails.Quantity" id="quantityInput" class="form-control" />
                        <span asp-validation-for="AdminUpdateDetails.Quantity" class="text-danger"></span>
                    </div>
                </form>
            </div>
            <form>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary closeBtnModal">Close</button>

                    <input type="submit" value="Update product"
                           class="btn btn-primary updateBtnModal" />
                </div>
            </form>
        </div>
    </div>
</div>
